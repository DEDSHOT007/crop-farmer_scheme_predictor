<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Farmer Scheme Eligibility Predictor</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <div class="form-container">
    <h1 center>CROPðŸŒ±</h1>
    <h1>Farmer Scheme Eligibility Predictor</h1>
    <form method="POST" action="/predict">
      <label for="age">Age:</label>
      <select name="age" required>
        {% for age in age_range %}
          <option value="{{ age }}">{{ age }}</option>
        {% endfor %}
      </select>

      <label for="gender">Gender:</label>
      <select name="gender" required>
        {% for g in genders %}
          <option value="{{ g }}">{{ g }}</option>
        {% endfor %}
      </select>

      <label for="education">Education:</label>
      <select name="education" required>
        {% for e in educations %}
          <option value="{{ e }}">{{ e }}</option>
        {% endfor %}
      </select>

      <label for="annual_income">Annual Income (â‚¹):</label>
      <input type="number" step="0.01" name="annual_income" id="annual_income" required placeholder="e.g. 25000 - 1000000" min="25000" max="1000000">

      <label for="land_size_acres">Land Size (in acres):</label>
      <input type="number" step="0.01" name="land_size_acres" id="land_size_acres" required placeholder="e.g. 0.5 - 100" min="0.5" max="100">

      <label for="crop_type">Crop Type:</label>
      <select name="crop_type" required>
        {% for crop in crop_types %}
          <option value="{{ crop }}">{{ crop }}</option>
        {% endfor %}
      </select>

      <label for="state">State:</label>
      <select name="state" id="state" required>
        {% for state in states %}
          <option value="{{ state }}">{{ state }}</option>
        {% endfor %}
      </select>

      <label for="district">District:</label>
      <select name="district" id="district" required>
        {% for district in districts %}
          <option value="{{ district }}">{{ district }}</option>
        {% endfor %}
      </select>

      <label for="region">Region:</label>
      <select name="region" id="region" required>
        {% for region in regions %}
          <option value="{{ region }}">{{ region }}</option>
        {% endfor %}
      </select>

      <label for="has_taken_crop_insurance">Crop Insurance Taken?</label>
      <select name="has_taken_crop_insurance" required>
        <option value="1">Yes</option>
        <option value="0">No</option>
      </select>

      <button type="submit">Predict Eligibility</button>
    </form>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const stateSelect = document.getElementById("state");
      const districtSelect = document.getElementById("district");
      const regionSelect = document.getElementById("region");

      stateSelect.addEventListener("change", function () {
        const selectedState = this.value;

        fetch("/get_districts_and_regions", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ state: selectedState })
        })
        .then(response => response.json())
        .then(data => {
          // Update district options
          districtSelect.innerHTML = "";
          data.districts.forEach(d => {
            const opt = document.createElement("option");
            opt.value = d;
            opt.textContent = d;
            districtSelect.appendChild(opt);
          });

          // Update region options
          regionSelect.innerHTML = "";
          data.regions.forEach(r => {
            const opt = document.createElement("option");
            opt.value = r;
            opt.textContent = r;
            regionSelect.appendChild(opt);
          });
        });
      });
    });

    document.querySelector('form').addEventListener('submit', function(e) {
      // Validate Annual Income
      const annualIncome = parseFloat(document.getElementById('annual_income').value);
      if (isNaN(annualIncome) || annualIncome < 25000 || annualIncome > 1000000) {
        alert('Please enter a valid annual income between â‚¹25,000 and â‚¹10,00,000.');
        e.preventDefault();
        return;
      }

      // Validate Land Size
      const landSize = parseFloat(document.getElementById('land_size_acres').value);
      if (isNaN(landSize) || landSize < 0.5 || landSize > 100) {
        alert('Please enter a valid land size between 0.5 and 100 acres.');
        e.preventDefault();
        return;
      }
    });
  </script>
</body>
</html>
